[config]
# Don't run tasks in workspace members by default
default_to_workspace = false

[tasks.default]
description = "Run the default task (dev)"
command = "cargo"
args = ["run", "-p", "md-server", "--", "start"]

[tasks.dev]
description = "Run the development server with hot-reload"
script = [
  "systemfd --no-pid -s http::3025 -- watchexec -r -- cargo run -p md-server -- start"
]

[tasks.stop]
description = "Stop the running server daemon"
command = "cargo"
args = ["run", "-p", "md-server", "--", "stop"]

[tasks.build]
description = "Build the workspace in debug mode"
command = "cargo"
args = ["build", "--workspace"]

[tasks.release]
description = "Build the workspace in release mode"
command = "cargo"
args = ["build", "--workspace", "--release"]

[tasks.test]
description = "Run all tests"
command = "cargo"
args = ["test", "--workspace"]

[tasks.test-verbose]
description = "Run all tests with verbose output"
command = "cargo"
args = ["test", "--workspace", "--", "--nocapture"]

[tasks.fmt]
description = "Format the codebase using rustfmt"
command = "cargo"
args = ["fmt", "--all"]

[tasks.fmt-check]
description = "Check if code is formatted without making changes"
command = "cargo"
args = ["fmt", "--all", "--", "--check"]

[tasks.check]
description = "Check the code without building"
command = "cargo"
args = ["check", "--workspace"]

[tasks.clippy]
description = "Run clippy linter"
command = "cargo"
args = ["clippy", "--workspace", "--", "-D", "warnings"]

[tasks.clean]
description = "Clean build artifacts"
command = "cargo"
args = ["clean"]

[tasks.commit]
description = "Run format, clippy, test, and build"
dependencies = ["fmt", "check", "test"]
script = ["git add ."]

[tasks.install]
description = "Install the CLI binary"
command = "cargo"
args = ["install", "--path", "cli"]
